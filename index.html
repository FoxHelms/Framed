<!DOCTYPE html>
<html>
    <script src="variables.js"></script>
    <script>

        function getRandomIntInclusive(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            shotType = Math.floor(Math.random() * (max - min + 1) + min); // The maximum is inclusive and the minimum is inclusive
            answer = Object.keys(shots)[shotType];
            fileName = JSON.stringify(answer).replace(/\s/g, '').replace(/['"]+/g, '');
            guesses = 0;
            imgInd = 1;
            document.getElementById("image").src="imgs/" + fileName + imgInd + ".jpg";
            document.getElementById("tryAgain").style="display: none";
            for (let i = 1; i < 4; i++) {
                document.getElementById("img" + i).style="display: none";
            }
            //window.location.reload();
        }


        function myFunction(){
            //get input
            var entry = document.getElementById("guess").value;
            //entry = entry.replace(/\s/g, '');
            


            //strip entry of 'shot' or 'angle'
            lowerEntry = entry.toLowerCase();
            if(lowerEntry.includes("shot")){
                entry = entry.replace(" shot", '');
            }
            if(lowerEntry.includes("angle")){
                entry = entry.replace(" angle", '');
            }

            if(answer == "extreme close up"){
                if(entry == "ecu"){
                    entry = "extreme close up";
                }
            }

            //const answer = Object.keys(shots)[shotType];
            if(entry == answer){
                alert(entry + " is correct");
                shotType++;
                answer = Object.keys(shots)[shotType];
                fileName = JSON.stringify(answer).replace(/\s/g, '').replace(/['"]+/g, '');
                guesses = 0;
                imgInd = 1;
                document.getElementById("image").src="imgs/" + fileName + imgInd + ".jpg";
                document.getElementById("tryAgain").style="display: none";
                for (let i = 1; i < 3; i++) {
                    document.getElementById("guess" + i).innerText='';
                    document.getElementById("guess" + i).style="display: none";
                }
            }
            else{
                imgInd++;
                guesses ++;
            }
            if(guesses == 3){
                alert("You have run out of guesses!");
            }
            //show previous image button
            if(guesses != 0){
                for (let i = 1; i < guesses+2; i++) {
                    document.getElementById("img" + i).style="display: ''";
                    document.getElementById("tryAgain").style="display: ''";
                    document.getElementById("guess" + guesses).innerText=entry;
                    document.getElementById("guess" + guesses).style="display: ''";
                }
            }
            //check if correct, otherwise go to next image
            //update image
            document.getElementById("image").src="imgs/" + fileName + imgInd + ".jpg";
            //reset input field
            document.getElementById("guess").value = "";
            //don't refresh page
            return false;
        }
    </script>
    <head>
    <link rel="stylesheet" href="mystyle.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    </head>
    <body>
        <img width="640" height="360" id="image"/>
        <h1>Name That Shot</h1>

        <div class="other_images">
        <button id="img1" style="display: none" onclick="document.getElementById('image').src='imgs/' + fileName + 1 + '.jpg'">1</button>
        <button id="img2" style="display: none" onclick="document.getElementById('image').src='imgs/' + fileName + 2 + '.jpg'">2</button>
        <button id="img3" style="display: none" onclick="document.getElementById('image').src='imgs/' + fileName + 3 + '.jpg'">3</button>
        </div>
        <h2 id="tryAgain" style="display: none">Wrong! Try Again</h2>
        
        <form onsubmit="return myFunction();">
            <input type="text" placeholder="Shot Type" id="guess" autocomplete="off" class="textfield"/>
            <!--input type="submit" value="guess" /-->
            <span type="submit" class="material-symbols-outlined" onclick="myFunction();">keyboard_double_arrow_right</span>
            <span type="button" class="material-symbols-outlined" onclick="getRandomIntInclusive(1, 7);">refresh</span>
            <!--input type="button" id="cycle"value="new shot" onclick="getRandomIntInclusive(1, 7);" /-->
        </form>

        <p id="guess1" style="display: none"></p>
        <p id="guess2" style="display: none"></p>

        

        <script>
            //use date to choose shot type
            //const date = new Date();
            //let today = date.getDate();
            //let shotOpt = 3;
            //const shotType = today % shotOpt;

            //uncomment below to test shot type selector
            var shotType = 0;

            
            //get answer as HR string from dictionary. 
            var answer = Object.keys(shots)[shotType];
            var fileName = JSON.stringify(answer).replace(/\s/g, '').replace(/['"]+/g, '');
            document.getElementById("image").src="imgs/" + fileName + imgInd + ".jpg";

            //if you don't want to constantiate, use dict like so:
            //var fileName = Object.values(shots)[shotType][guesses];
            //document.getElementById("image").src="imgs/" + fileName;
            
        </script>

    </body>

</html>

